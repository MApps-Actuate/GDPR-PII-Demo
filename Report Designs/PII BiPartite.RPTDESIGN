<?xml version="1.0" encoding="UTF-8"?>
<report xmlns="http://www.eclipse.org/birt/2005/design" version="3.2.23" id="1">
    <property name="createdBy">Eclipse BIRT Designer Version 4.8.0.v201804241733</property>
    <property name="units">in</property>
    <property name="theme">ThemesReportItems31.Modern</property>
    <property name="iconFile">/templates/blank_report.gif</property>
    <property name="layoutPreference">auto layout</property>
    <property name="bidiLayoutOrientation">ltr</property>
    <property name="imageDPI">96</property>
    <list-property name="libraries">
        <structure>
            <property name="fileName">/ThemesReportItems31.rptlibrary</property>
            <property name="namespace">ThemesReportItems31</property>
        </structure>
    </list-property>
    <data-sources>
        <oda-data-source extensionID="org.eclipse.birt.report.data.oda.jdbc" name="Classic Models Data Source" id="43">
            <list-property name="privateDriverProperties">
                <ex-property>
                    <name>contentBidiFormatStr</name>
                    <value>ILYNN</value>
                </ex-property>
                <ex-property>
                    <name>metadataBidiFormatStr</name>
                    <value>ILYNN</value>
                </ex-property>
            </list-property>
            <property name="odaDriverClass">org.eclipse.birt.report.data.oda.sampledb.Driver</property>
            <property name="odaURL">jdbc:classicmodels:sampledb</property>
            <property name="odaUser">ClassicModels</property>
        </oda-data-source>
        <data-mart-data-source name="PII Data Source" id="45">
            <property name="datamartURL">Data Objects/Text Analytics</property>
            <property name="accessType">latest</property>
        </data-mart-data-source>
    </data-sources>
    <data-sets>
        <oda-data-set extensionID="org.eclipse.birt.report.data.oda.jdbc.JdbcSelectDataSet" name="Customers and Payments Data Set" id="44">
            <list-property name="columnHints">
                <structure>
                    <property name="columnName">COUNTRY</property>
                    <property name="analysis">dimension</property>
                    <text-property name="displayName">COUNTRY</text-property>
                    <property name="onColumnLayout">false</property>
                    <text-property name="heading">COUNTRY</text-property>
                </structure>
                <structure>
                    <property name="columnName">CREDITCATEGORY</property>
                    <property name="analysis">dimension</property>
                    <text-property name="displayName">CREDITCATEGORY</text-property>
                    <property name="onColumnLayout">false</property>
                    <text-property name="heading">CREDITCATEGORY</text-property>
                </structure>
                <structure>
                    <property name="columnName">TOTALCUSTOMERS</property>
                    <property name="analysis">measure</property>
                    <text-property name="displayName">TOTALCUSTOMERS</text-property>
                    <text-property name="heading">TOTALCUSTOMERS</text-property>
                </structure>
                <structure>
                    <property name="columnName">TOTALORDERS</property>
                    <property name="analysis">measure</property>
                    <text-property name="displayName">TOTALORDERS</text-property>
                    <text-property name="heading">TOTALORDERS</text-property>
                </structure>
            </list-property>
            <list-property name="parameters"/>
            <structure name="cachedMetaData">
                <list-property name="resultSet">
                    <structure>
                        <property name="position">1</property>
                        <property name="name">COUNTRY</property>
                        <property name="dataType">string</property>
                    </structure>
                    <structure>
                        <property name="position">2</property>
                        <property name="name">CREDITCATEGORY</property>
                        <property name="dataType">string</property>
                    </structure>
                    <structure>
                        <property name="position">3</property>
                        <property name="name">TOTALCUSTOMERS</property>
                        <property name="dataType">integer</property>
                    </structure>
                    <structure>
                        <property name="position">4</property>
                        <property name="name">TOTALORDERS</property>
                        <property name="dataType">integer</property>
                    </structure>
                </list-property>
            </structure>
            <property name="dataSource">Classic Models Data Source</property>
            <list-property name="resultSet">
                <structure>
                    <property name="position">1</property>
                    <property name="name">COUNTRY</property>
                    <property name="nativeName">COUNTRY</property>
                    <property name="dataType">string</property>
                    <property name="nativeDataType">12</property>
                </structure>
                <structure>
                    <property name="position">2</property>
                    <property name="name">CREDITCATEGORY</property>
                    <property name="nativeName">CREDITCATEGORY</property>
                    <property name="dataType">string</property>
                    <property name="nativeDataType">12</property>
                </structure>
                <structure>
                    <property name="position">3</property>
                    <property name="name">TOTALCUSTOMERS</property>
                    <property name="nativeName">TOTALCUSTOMERS</property>
                    <property name="dataType">integer</property>
                    <property name="nativeDataType">4</property>
                </structure>
                <structure>
                    <property name="position">4</property>
                    <property name="name">TOTALORDERS</property>
                    <property name="nativeName">TOTALORDERS</property>
                    <property name="dataType">integer</property>
                    <property name="nativeDataType">4</property>
                </structure>
            </list-property>
            <xml-property name="queryText"><![CDATA[SELECT T1.COUNTRY, T1.CreditCategory, COUNT(T1.COUNTRY) as TotalCustomers,  SUM(TotalOrders) as TotalOrders
FROM
(
SELECT CLASSICMODELS.CUSTOMERS.COUNTRY,
	 	CLASSICMODELS.CUSTOMERS.CUSTOMERNAME,
	 	COUNT(CLASSICMODELS.ORDERS.ORDERNUMBER) as TotalOrders,

	( CASE 
          WHEN CLASSICMODELS.CUSTOMERS.CREDITLIMIT < 35001 THEN 'Low'
          WHEN CLASSICMODELS.CUSTOMERS.CREDITLIMIT BETWEEN 35001 AND 100000 THEN 'Medium'
          WHEN CLASSICMODELS.CUSTOMERS.CREDITLIMIT> 100000 THEN 'High'
        END ) as CreditCategory
        
FROM CLASSICMODELS.CUSTOMERS, CLASSICMODELS.ORDERS

WHERE CLASSICMODELS.CUSTOMERS.CUSTOMERNUMBER = CLASSICMODELS.ORDERS.CUSTOMERNUMBER

GROUP BY CLASSICMODELS.CUSTOMERS.COUNTRY, CLASSICMODELS.CUSTOMERS.CUSTOMERNAME,
	( CASE 
          WHEN CLASSICMODELS.CUSTOMERS.CREDITLIMIT < 35001 THEN 'Low'
          WHEN CLASSICMODELS.CUSTOMERS.CREDITLIMIT BETWEEN 35001 AND 100000 THEN 'Medium'
          WHEN CLASSICMODELS.CUSTOMERS.CREDITLIMIT> 100000 THEN 'High'
        END )
) AS T1
GROUP BY T1.COUNTRY, T1.CreditCategory]]></xml-property>
            <xml-property name="designerValues"><![CDATA[<?xml version="1.0" encoding="UTF-8"?>
<model:DesignValues xmlns:design="http://www.eclipse.org/datatools/connectivity/oda/design" xmlns:model="http://www.eclipse.org/birt/report/model/adapter/odaModel">
  <Version>2.0</Version>
  <design:ResultSets derivedMetaData="true">
    <design:resultSetDefinitions>
      <design:resultSetColumns>
        <design:resultColumnDefinitions>
          <design:attributes>
            <design:identifier>
              <design:name>CUSTOMERNUMBER</design:name>
              <design:position>1</design:position>
            </design:identifier>
            <design:nativeDataTypeCode>4</design:nativeDataTypeCode>
            <design:precision>10</design:precision>
            <design:scale>0</design:scale>
            <design:nullability>Nullable</design:nullability>
            <design:uiHints>
              <design:displayName>CUSTOMERNUMBER</design:displayName>
            </design:uiHints>
          </design:attributes>
          <design:usageHints>
            <design:label>CUSTOMERNUMBER</design:label>
            <design:formattingHints>
              <design:displaySize>11</design:displaySize>
            </design:formattingHints>
          </design:usageHints>
        </design:resultColumnDefinitions>
        <design:resultColumnDefinitions>
          <design:attributes>
            <design:identifier>
              <design:name>CUSTOMERNAME</design:name>
              <design:position>2</design:position>
            </design:identifier>
            <design:nativeDataTypeCode>12</design:nativeDataTypeCode>
            <design:precision>50</design:precision>
            <design:scale>0</design:scale>
            <design:nullability>Nullable</design:nullability>
            <design:uiHints>
              <design:displayName>CUSTOMERNAME</design:displayName>
            </design:uiHints>
          </design:attributes>
          <design:usageHints>
            <design:label>CUSTOMERNAME</design:label>
            <design:formattingHints>
              <design:displaySize>50</design:displaySize>
            </design:formattingHints>
          </design:usageHints>
        </design:resultColumnDefinitions>
        <design:resultColumnDefinitions>
          <design:attributes>
            <design:identifier>
              <design:name>CONTACTLASTNAME</design:name>
              <design:position>3</design:position>
            </design:identifier>
            <design:nativeDataTypeCode>12</design:nativeDataTypeCode>
            <design:precision>50</design:precision>
            <design:scale>0</design:scale>
            <design:nullability>Nullable</design:nullability>
            <design:uiHints>
              <design:displayName>CONTACTLASTNAME</design:displayName>
            </design:uiHints>
          </design:attributes>
          <design:usageHints>
            <design:label>CONTACTLASTNAME</design:label>
            <design:formattingHints>
              <design:displaySize>50</design:displaySize>
            </design:formattingHints>
          </design:usageHints>
        </design:resultColumnDefinitions>
        <design:resultColumnDefinitions>
          <design:attributes>
            <design:identifier>
              <design:name>CONTACTFIRSTNAME</design:name>
              <design:position>4</design:position>
            </design:identifier>
            <design:nativeDataTypeCode>12</design:nativeDataTypeCode>
            <design:precision>50</design:precision>
            <design:scale>0</design:scale>
            <design:nullability>Nullable</design:nullability>
            <design:uiHints>
              <design:displayName>CONTACTFIRSTNAME</design:displayName>
            </design:uiHints>
          </design:attributes>
          <design:usageHints>
            <design:label>CONTACTFIRSTNAME</design:label>
            <design:formattingHints>
              <design:displaySize>50</design:displaySize>
            </design:formattingHints>
          </design:usageHints>
        </design:resultColumnDefinitions>
        <design:resultColumnDefinitions>
          <design:attributes>
            <design:identifier>
              <design:name>PHONE</design:name>
              <design:position>5</design:position>
            </design:identifier>
            <design:nativeDataTypeCode>12</design:nativeDataTypeCode>
            <design:precision>50</design:precision>
            <design:scale>0</design:scale>
            <design:nullability>Nullable</design:nullability>
            <design:uiHints>
              <design:displayName>PHONE</design:displayName>
            </design:uiHints>
          </design:attributes>
          <design:usageHints>
            <design:label>PHONE</design:label>
            <design:formattingHints>
              <design:displaySize>50</design:displaySize>
            </design:formattingHints>
          </design:usageHints>
        </design:resultColumnDefinitions>
        <design:resultColumnDefinitions>
          <design:attributes>
            <design:identifier>
              <design:name>ADDRESSLINE1</design:name>
              <design:position>6</design:position>
            </design:identifier>
            <design:nativeDataTypeCode>12</design:nativeDataTypeCode>
            <design:precision>50</design:precision>
            <design:scale>0</design:scale>
            <design:nullability>Nullable</design:nullability>
            <design:uiHints>
              <design:displayName>ADDRESSLINE1</design:displayName>
            </design:uiHints>
          </design:attributes>
          <design:usageHints>
            <design:label>ADDRESSLINE1</design:label>
            <design:formattingHints>
              <design:displaySize>50</design:displaySize>
            </design:formattingHints>
          </design:usageHints>
        </design:resultColumnDefinitions>
        <design:resultColumnDefinitions>
          <design:attributes>
            <design:identifier>
              <design:name>ADDRESSLINE2</design:name>
              <design:position>7</design:position>
            </design:identifier>
            <design:nativeDataTypeCode>12</design:nativeDataTypeCode>
            <design:precision>50</design:precision>
            <design:scale>0</design:scale>
            <design:nullability>Nullable</design:nullability>
            <design:uiHints>
              <design:displayName>ADDRESSLINE2</design:displayName>
            </design:uiHints>
          </design:attributes>
          <design:usageHints>
            <design:label>ADDRESSLINE2</design:label>
            <design:formattingHints>
              <design:displaySize>50</design:displaySize>
            </design:formattingHints>
          </design:usageHints>
        </design:resultColumnDefinitions>
        <design:resultColumnDefinitions>
          <design:attributes>
            <design:identifier>
              <design:name>CITY</design:name>
              <design:position>8</design:position>
            </design:identifier>
            <design:nativeDataTypeCode>12</design:nativeDataTypeCode>
            <design:precision>50</design:precision>
            <design:scale>0</design:scale>
            <design:nullability>Nullable</design:nullability>
            <design:uiHints>
              <design:displayName>CITY</design:displayName>
            </design:uiHints>
          </design:attributes>
          <design:usageHints>
            <design:label>CITY</design:label>
            <design:formattingHints>
              <design:displaySize>50</design:displaySize>
            </design:formattingHints>
          </design:usageHints>
        </design:resultColumnDefinitions>
        <design:resultColumnDefinitions>
          <design:attributes>
            <design:identifier>
              <design:name>STATE</design:name>
              <design:position>9</design:position>
            </design:identifier>
            <design:nativeDataTypeCode>12</design:nativeDataTypeCode>
            <design:precision>50</design:precision>
            <design:scale>0</design:scale>
            <design:nullability>Nullable</design:nullability>
            <design:uiHints>
              <design:displayName>STATE</design:displayName>
            </design:uiHints>
          </design:attributes>
          <design:usageHints>
            <design:label>STATE</design:label>
            <design:formattingHints>
              <design:displaySize>50</design:displaySize>
            </design:formattingHints>
          </design:usageHints>
        </design:resultColumnDefinitions>
        <design:resultColumnDefinitions>
          <design:attributes>
            <design:identifier>
              <design:name>POSTALCODE</design:name>
              <design:position>10</design:position>
            </design:identifier>
            <design:nativeDataTypeCode>12</design:nativeDataTypeCode>
            <design:precision>15</design:precision>
            <design:scale>0</design:scale>
            <design:nullability>Nullable</design:nullability>
            <design:uiHints>
              <design:displayName>POSTALCODE</design:displayName>
            </design:uiHints>
          </design:attributes>
          <design:usageHints>
            <design:label>POSTALCODE</design:label>
            <design:formattingHints>
              <design:displaySize>15</design:displaySize>
            </design:formattingHints>
          </design:usageHints>
        </design:resultColumnDefinitions>
        <design:resultColumnDefinitions>
          <design:attributes>
            <design:identifier>
              <design:name>COUNTRY</design:name>
              <design:position>11</design:position>
            </design:identifier>
            <design:nativeDataTypeCode>12</design:nativeDataTypeCode>
            <design:precision>50</design:precision>
            <design:scale>0</design:scale>
            <design:nullability>Nullable</design:nullability>
            <design:uiHints>
              <design:displayName>COUNTRY</design:displayName>
            </design:uiHints>
          </design:attributes>
          <design:usageHints>
            <design:label>COUNTRY</design:label>
            <design:formattingHints>
              <design:displaySize>50</design:displaySize>
            </design:formattingHints>
          </design:usageHints>
        </design:resultColumnDefinitions>
        <design:resultColumnDefinitions>
          <design:attributes>
            <design:identifier>
              <design:name>SALESREPEMPLOYEENUMBER</design:name>
              <design:position>12</design:position>
            </design:identifier>
            <design:nativeDataTypeCode>4</design:nativeDataTypeCode>
            <design:precision>10</design:precision>
            <design:scale>0</design:scale>
            <design:nullability>Nullable</design:nullability>
            <design:uiHints>
              <design:displayName>SALESREPEMPLOYEENUMBER</design:displayName>
            </design:uiHints>
          </design:attributes>
          <design:usageHints>
            <design:label>SALESREPEMPLOYEENUMBER</design:label>
            <design:formattingHints>
              <design:displaySize>11</design:displaySize>
            </design:formattingHints>
          </design:usageHints>
        </design:resultColumnDefinitions>
        <design:resultColumnDefinitions>
          <design:attributes>
            <design:identifier>
              <design:name>CREDITLIMIT</design:name>
              <design:position>13</design:position>
            </design:identifier>
            <design:nativeDataTypeCode>8</design:nativeDataTypeCode>
            <design:precision>15</design:precision>
            <design:scale>0</design:scale>
            <design:nullability>Nullable</design:nullability>
            <design:uiHints>
              <design:displayName>CREDITLIMIT</design:displayName>
            </design:uiHints>
          </design:attributes>
          <design:usageHints>
            <design:label>CREDITLIMIT</design:label>
            <design:formattingHints>
              <design:displaySize>22</design:displaySize>
            </design:formattingHints>
          </design:usageHints>
        </design:resultColumnDefinitions>
      </design:resultSetColumns>
      <design:criteria/>
    </design:resultSetDefinitions>
  </design:ResultSets>
</model:DesignValues>]]></xml-property>
        </oda-data-set>
    </data-sets>
    <property name="linkedDataModels">
        <data-mart-linked-data-model name="PII Data Model" id="46">
            <property name="dataSource">PII Data Source</property>
            <property name="dataObject">Data Model</property>
        </data-mart-linked-data-model>
    </property>
    <page-setup>
        <simple-master-page name="Simple MasterPage" id="2">
            <property name="type">custom</property>
            <property name="orientation">landscape</property>
            <property name="height">12in</property>
            <property name="width">13in</property>
            <property name="headerHeight">0.1in</property>
            <property name="footerHeight">0.1in</property>
        </simple-master-page>
    </page-setup>
    <body>
        <grid id="4">
            <property name="height">9.875in</property>
            <column id="5"/>
            <row id="12">
                <property name="height">8.125in</property>
                <cell id="13">
                    <extended-item extensionName="HTMLControl" id="29">
                        <property name="html">&lt;div id="myChart">&lt;/div></property>
                        <property name="css">svg text{&#13;
	font-size:10px;&#13;
}&#13;
rect{&#13;
	shape-rendering:crispEdges;&#13;
}&#13;
&#13;
&#13;
.mainBars rect{&#13;
  shape-rendering: auto;&#13;
  fill-opacity: 0;&#13;
  stroke-width: 0.5px;&#13;
  stroke: rgb(0, 0, 0);&#13;
  stroke-opacity: 0;&#13;
}&#13;
.subBars{&#13;
	shape-rendering:crispEdges;&#13;
}&#13;
.edges{&#13;
	stroke:none;&#13;
	fill-opacity:0.5;&#13;
}</property>
                        <method name="clientOnCreate"><![CDATA[//var customViz = this;
//var containerId = this.getId();
//var containerWidth = $("#" + containerId).width();
//var containerHeight = $("#" + containerId).height();

var data = this.getData().rows;

for (var i=0; i < data.length; i++) {
	data[i] = data[i].slice (0,3);
}


var callback = function () {
 
var color ={"Content Server":"#3366CC", "DOCS":"#DC3912",  "Documentum":"#FF9900", "File Share":"#109618"};
var svg = d3.select("#myChart").append("svg").attr("width", 960).attr("height", 800);
var g = svg.append("g").attr("transform","translate(200,50)");

var bp=viz.bP()
		.data(data)
		.min(12)
		.pad(10)
		.height(600)
		.width(500)
		.barSize(35)
		//.orient("horizontal")
		.fill(d=>color[d.primary]);
			
g.call(bp);

g.selectAll(".mainBars")
	.on("mouseover",mouseover)
	.on("mouseout",mouseout)

g.selectAll(".mainBars").append("text").attr("class","label")
	.attr("x",d=>(d.part=="primary"? -30: 30))
	.attr("y",d=>+6)
	.text(d=>d.key)
	.attr("text-anchor",d=>(d.part=="primary"? "end": "start"));
	
g.selectAll(".mainBars").append("text").attr("class","perc")
	.attr("x",d=>(d.part=="primary"? -100: 170))
	.attr("y",d=>+6)
	.text(function(d){ return d3.format("0.0%")(d.percent)})
	.attr("text-anchor",d=>(d.part=="primary"? "end": "start"));

function mouseover(d){
	bp.mouseover(d);
	g.selectAll(".mainBars")
	.select(".perc")
	.text(function(d){ return d3.format("0.0%")(d.percent)})
}
function mouseout(d){
	bp.mouseout(d);
	g.selectAll(".mainBars")
		.select(".perc")
	.text(function(d){ return d3.format("0.0%")(d.percent)})
}
d3.select(self.frameElement).style("height", "800px");

};

delete define.amd;

head.load('https://d3js.org/d3.v4.min.js', 'http://vizjs.org/viz.v1.1.0.min.js', callback);]]></method>
                        <property name="groups">
                            <data-group>
                                <property name="groupName">Source Group</property>
                                <expression name="keyExpr" type="javascript">data["random_content_type"]</expression>
                                <property name="interval">none</property>
                                <property name="sortDirection">asc</property>
                            </data-group>
                            <data-group>
                                <property name="groupName">Category Group</property>
                                <expression name="keyExpr" type="javascript">data["category"]</expression>
                                <property name="interval">none</property>
                                <property name="sortDirection">asc</property>
                            </data-group>
                        </property>
                        <list-property name="filter">
                            <structure>
                                <property name="operator">eq</property>
                                <expression name="expr" type="javascript">row["PII_status"]</expression>
                                <simple-property-list name="value1">
                                    <value>"PII detected"</value>
                                </simple-property-list>
                                <property name="updateAggregation">true</property>
                            </structure>
                            <structure>
                                <property name="operator">eq</property>
                                <expression name="expr" type="javascript">row["kb_name"]</expression>
                                <simple-property-list name="value1">
                                    <value>"PersonalInformation"</value>
                                </simple-property-list>
                                <property name="updateAggregation">true</property>
                            </structure>
                        </list-property>
                        <property name="summaryData">true</property>
                        <property name="height">7.635416666666667in</property>
                        <property name="width">12.239583333333334in</property>
                        <list-property name="boundDataColumns">
                            <structure>
                                <property name="name">random_content_type</property>
                                <text-property name="displayName">Source</text-property>
                                <expression name="expression" type="javascript">dataSetRow["random_content_type"]</expression>
                                <property name="dataType">string</property>
                            </structure>
                            <structure>
                                <property name="name">category</property>
                                <text-property name="displayName">Category</text-property>
                                <expression name="expression" type="javascript">dataSetRow["category"]</expression>
                                <property name="dataType">string</property>
                            </structure>
                            <structure>
                                <property name="name">Category Totals Distinct</property>
                                <property name="dataType">integer</property>
                                <simple-property-list name="aggregateOn">
                                    <value>Category Group</value>
                                </simple-property-list>
                                <property name="aggregateFunction">COUNTDISTINCT</property>
                                <list-property name="arguments">
                                    <structure>
                                        <property name="name">Expression</property>
                                        <expression name="value" type="javascript">row["doc_id"]</expression>
                                    </structure>
                                </list-property>
                                <property name="allowExport">true</property>
                            </structure>
                            <structure>
                                <property name="name">PII_status</property>
                                <text-property name="displayName">PII Status</text-property>
                                <expression name="expression" type="javascript">dataSetRow["PII_status"]</expression>
                                <property name="dataType">string</property>
                            </structure>
                            <structure>
                                <property name="name">Source Totals Distinct</property>
                                <property name="dataType">integer</property>
                                <simple-property-list name="aggregateOn">
                                    <value>Source Group</value>
                                </simple-property-list>
                                <property name="aggregateFunction">COUNTDISTINCT</property>
                                <list-property name="arguments">
                                    <structure>
                                        <property name="name">Expression</property>
                                        <expression name="value" type="javascript">row["doc_id"]</expression>
                                    </structure>
                                </list-property>
                                <property name="allowExport">true</property>
                            </structure>
                            <structure>
                                <property name="name">kb_name</property>
                                <text-property name="displayName">Knowledgebase Name</text-property>
                                <expression name="expression" type="javascript">dataSetRow["kb_name"]</expression>
                                <property name="dataType">string</property>
                            </structure>
                            <structure>
                                <property name="name">doc_id</property>
                                <expression name="expression" type="javascript">dataSetRow["doc_id"]</expression>
                                <property name="dataType">decimal</property>
                                <property name="allowExport">true</property>
                            </structure>
                        </list-property>
                        <property name="linkedDataModel">PII Data Model</property>
                        <property name="displayName">BiPartite Chart using D3.js --cwong</property>
                    </extended-item>
                </cell>
            </row>
        </grid>
    </body>
</report>
